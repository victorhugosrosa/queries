DECLARE @DT_INI AS DATE = GETDATE()-60;
DECLARE @DT_FIM AS DATE = GETDATE()-30;

select
	COD_LOJA
	,'PADARIA' AS AREA
	,'KG'AS UNIDADE
	,dbo.fn_FormataVlr_Excel(SUM(V.QTDE_PRODUTO)) AS QTD
FROM
	BI.dbo.BI_VENDA_PRODUTO AS V INNER JOIN BI.DBO.BI_CAD_PRODUTO AS P ON P.COD_PRODUTO = V.COD_PRODUTO
WHERE 1 = 1
	AND CONVERT(DATE,V.DATA) >= CONVERT(DATE,@DT_INI)
	AND CONVERT(DATE,V.DATA) <= CONVERT(DATE,@DT_FIM)
	AND P.COD_SECAO IN (32)
	AND P.PESADO = 'S'
GROUP BY
	COD_LOJA

UNION ALL

select
	COD_LOJA
	,'ACOUGUE' AS AREA
	,'KG'AS UNIDADE
	,dbo.fn_FormataVlr_Excel(SUM(V.QTDE_PRODUTO)) AS QTD
FROM
	BI.dbo.BI_VENDA_PRODUTO AS V INNER JOIN BI.DBO.BI_CAD_PRODUTO AS P ON P.COD_PRODUTO = V.COD_PRODUTO
WHERE 1 = 1
	AND CONVERT(DATE,V.DATA) >= CONVERT(DATE,@DT_INI)
	AND CONVERT(DATE,V.DATA) <= CONVERT(DATE,@DT_FIM)
	AND P.COD_SECAO IN (38)
	AND P.PESADO = 'S'
GROUP BY
	COD_LOJA
	
UNION ALL

select
	COD_LOJA
	,'FLV' AS AREA
	,'KG'AS UNIDADE
	,dbo.fn_FormataVlr_Excel(SUM(V.QTDE_PRODUTO)) AS QTD
FROM
	BI.dbo.BI_VENDA_PRODUTO AS V INNER JOIN BI.DBO.BI_CAD_PRODUTO AS P ON P.COD_PRODUTO = V.COD_PRODUTO
WHERE 1 = 1
	AND CONVERT(DATE,V.DATA) >= CONVERT(DATE,@DT_INI)
	AND CONVERT(DATE,V.DATA) <= CONVERT(DATE,@DT_FIM)
	AND P.COD_SECAO IN (25)
	AND P.PESADO = 'S'
GROUP BY
	COD_LOJA
	
UNION ALL

select
	COD_LOJA
	,'FRIOS' AS AREA
	,'KG'AS UNIDADE
	,dbo.fn_FormataVlr_Excel(SUM(V.QTDE_PRODUTO)) AS QTD
FROM
	BI.dbo.BI_VENDA_PRODUTO AS V INNER JOIN BI.DBO.BI_CAD_PRODUTO AS P ON P.COD_PRODUTO = V.COD_PRODUTO
WHERE 1 = 1
	AND CONVERT(DATE,V.DATA) >= CONVERT(DATE,@DT_INI)
	AND CONVERT(DATE,V.DATA) <= CONVERT(DATE,@DT_FIM)
	AND P.COD_PRODUTO IN
	(
	98137,
	87698,
	87629,
	29353,
	17565,
	1519,
	710,
	8938,
	2660,
	54867,
	970,
	2646,
	7696,
	26536,
	95723,
	95716,
	9096,
	3360,
	6767,
	96164,
	21432,
	2653,
	89661,
	95174,
	80316,
	9317,
	41201,
	3599,
	93200,
	74179,
	9256,
	87674,
	44554,
	80309,
	5593,
	9416,
	9522,
	4336,
	9126,
	7689,
	8815,
	8303,
	8693,
	9089,
	13611,
	7054,
	54843,
	1274,
	83775,
	94467,
	81856,
	72885,
	14649,
	2868,
	161,
	11921,
	93835,
	1366,
	26451,
	87773,
	13420,
	22002,
	45315,
	9027,
	48071,
	70485,
	42819,
	47999,
	6866,
	18975,
	93705,
	9706,
	94177,
	96973,
	87865,
	5920,
	72953,
	2165,
	1748,
	93576,
	31257,
	8259,
	13437,
	87841,
	21784,
	42901,
	95655,
	29339,
	21777,
	95341,
	2325,
	1441,
	528467,
	92296,
	2356,
	37440,
	39109,
	38768,
	10511,
	5623,
	6132,
	52252,
	84468,
	6750,
	17718,
	4381,
	6743,
	6057,
	13949,
	99141,
	9959,
	7009,
	8525,
	20367,
	17053,
	8440,
	11174,
	9904,
	8549,
	93002,
	83751,
	7191,
	772,
	7931,
	3148,
	28264,
	26239,
	27663,
	91824,
	4206,
	93224,
	18869,
	88497,
	11181,
	71512,
	69106,
	3803,
	89623,
	91367,
	91497,
	16223,
	88046,
	98687,
	2707,
	2288,
	98762,
	9942,
	7580,
	5555,
	2134,
	74278,
	98922,
	8563,
	12645,
	41645,
	25539,
	1809,
	74216,
	8594,
	10108,
	94856,
	8617,
	45155,
	9874,
	6590,
	74346,
	8990,
	24,
	83089,
	94023,
	6675,
	74230,
	38997,
	8730,
	2691,
	41461,
	74261,
	2509,
	86,
	4091,
	4084,
	5432,
	4220,
	9867,
	482,
	8969,
	20022,
	93330,
	3124,
	47234,
	24693,
	3711,
	6729,
	2783,
	7139,
	6873,
	80965,
	5340,
	11235,
	11198,
	11204,
	9935,
	12584,
	14793,
	14847,
	18968,
	8600,
	14816,
	14748,
	14113,
	14106,
	14236,
	20039,
	13871,
	11945,
	82389,
	11167,
	20053,
	11099,
	11082
	)
GROUP BY
	COD_LOJA

UNION ALL

select
	COD_LOJA
	,'REPOSITOR' AS AREA
	,'ITENS'AS UNIDADE
	,dbo.fn_FormataVlr_Excel(SUM(V.QTDE_PRODUTO)) AS QTD
FROM
	BI.dbo.BI_VENDA_PRODUTO AS V INNER JOIN BI.DBO.BI_CAD_PRODUTO AS P ON P.COD_PRODUTO = V.COD_PRODUTO
WHERE 1 = 1
	AND CONVERT(DATE,V.DATA) >= CONVERT(DATE,@DT_INI)
	AND CONVERT(DATE,V.DATA) <= CONVERT(DATE,@DT_FIM)
	AND P.COD_SECAO IN (9,21,26,29,30,33)
	AND P.PESADO = 'N'
GROUP BY
	COD_LOJA
	
UNION ALL

select
	COD_LOJA
	,'FRENTE DE CAIXA' AS AREA
	,'CUPONS'AS UNIDADE
	,dbo.fn_FormataVlr_Excel(SUM(V.QTDE_CUPOM)) AS QTD
FROM
	BI.dbo.BI_VENDA_CUPOM AS V
WHERE 1 = 1
	AND CONVERT(DATE,V.DATA) >= CONVERT(DATE,@DT_INI)
	AND CONVERT(DATE,V.DATA) <= CONVERT(DATE,@DT_FIM)
GROUP BY
	COD_LOJA
