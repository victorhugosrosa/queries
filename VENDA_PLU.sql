SELECT
	CP.NO_DEPARTAMENTO
	,CP.NO_SECAO
	,CP.NO_GRUPO
	,CP.COD_PRODUTO
	,CP.DESCRICAO AS NO_PRODUTO
	,CP.FORA_LINHA
	,YEAR(VP.DATA) AS ANO
	--,MONTH(VP.DATA) AS MES
	,BI.dbo.fn_FormataVlr_Excel(SUM(VP.VALOR_TOTAL)) AS VLR_TOTAL
	,BI.dbo.fn_FormataVlr_Excel(SUM(VP.QTDE_PRODUTO)) AS QTD_TOTAL
FROM
	BI.dbo.BI_CAD_PRODUTO AS CP
	INNER JOIN BI.dbo.BI_VENDA_PRODUTO AS VP
		ON 1=1
		AND CP.COD_PRODUTO = VP.COD_PRODUTO
WHERE 1=1
	AND CONVERT(DATE,VP.DATA) BETWEEN CONVERT(DATE,'20120101') AND CONVERT(DATE,'20141231')
	AND CP.COD_PRODUTO IN (19088,19477,19484,19491,71741,71758,71765,71772,103848,115131,123402,128513,128520,170413,170420,200318,202213,202220,245586,296038,301855,428668,488129,488136,581899,585828,596374,596404,902267,902274,922630,922647,922678,995281,1014749,1016191,995290,995291,995282,995284,995292,995289,1016191,995285,995287,995288,995286)
GROUP BY
	CP.NO_DEPARTAMENTO
	,CP.NO_SECAO
	,CP.NO_GRUPO
	,CP.COD_PRODUTO
	,CP.DESCRICAO
	,CP.FORA_LINHA
	,YEAR(VP.DATA)
	--,MONTH(VP.DATA)
ORDER BY
	CP.NO_DEPARTAMENTO
	,CP.NO_SECAO
	,CP.NO_GRUPO
	,CP.COD_PRODUTO
	,CP.DESCRICAO
	,CP.FORA_LINHA
	,YEAR(VP.DATA)
	--,MONTH(VP.DATA)